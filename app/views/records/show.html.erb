<h2>Servicio: <%= @record.id %></h2>

<h5>Registro creado por: <%= @record.user.name %> </h5>

<div class="row">
  <div id="status">
    <ul>
      <li><h5>Status Op: <%= @record.status_op %></h5></li>
      <li><h5>Status Amin: <%= @record.status_admin %></h5></li>
    </ul>
  </div>
</div>

<div class="row">
  <div class="col-md-6">
    <div id="formario">


      <h2><%= @record.title %></h2>

      <div class="row">
        <div class="col-sm-6">
          <h4>Fecha de Salida:</h4>
          <p><%= @record.try(:start_time).strftime(" %b-%d-%Y") %></p>
        </div>

        <div class="col-sm-6">
          <h4>Fecha de Regreso:</h4>
          <p><%= @record.try(:end_time).strftime(" %b-%d-%Y") %></p>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <h4>Hora de Salida:</h4>
          <p><%= @record.initial_time %></p>
        </div>

        <div class="col-sm-6">
          <h4>Hora de Regreso:</h4>
          <p><%= @record.finish_time %></p>
        </div>
      </div>


      <br><br>
      <div class="row">
        <div class="col-sm-6">
          <h4>Número de Pasajeros:</h4>
          <p><%= @record.numero_pasajeros %></p>
        </div>

        <div class="col-sm-6">
          <h4>Número de Camiones:</h4>
          <p><%= @record.numero_de_camiones %></p>
        </div>
      </div>

      <br><br>
      <div class="row">
        <div class="col-sm-6">
          <h4>Lugar de Salida:</h4>
          <p><%= @record.lugar_salida %></p>
        </div>

        <div class="col-sm-6">
          <h4>Referencia de Salida:</h4>
          <p><%= @record.referencia_salida %></p>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <h4>Nombre de Referencia:</h4>
          <p><%= @record.nombre_referencia %></p>
        </div>

        <div class="col-sm-6">
          <h4>Teléfono de Referencia:</h4>
          <p><%= @record.telefono_referencia %></p>
        </div>
      </div>


      <br><br>
      <div class="row">
        <div class="col-sm-6">
          <h4>¿Requiere Factura?</h4>
          <p><%= @record.factura %></p>
        </div>

        <div class="col-sm-6">
          <h4>Número de Factura o Recibo</h4>
          <p><%= @record.num_factura %></p>
        </div>
      </div>


      <br><br>
      <div class="row">
        <div class="col-sm-12">
          <h4>Observaciones:</h4>
          <p><%= @record.observaciones %></p><br>
        </div>
      </div>

    </div>

    <div id="formario">

      <h2>Precios</h2>
      <div class="row">
        <div class="col-sm-6">
          <h4>Precio:</h4>
          <p><%= @record.precio %></p>
        </div>
        <div class="col-sm-6">
          <h4>Precio Final:</h4>
          <p><%= @record.precio_final %></p>
        </div>
      </div>
    </div>

  </div>


  <div class="col-md-6">

<% if @record.services.count < @record.numero_de_camiones %>
    <div id="formario">
      <h2>Autobuses: <%=@record.services.count%>/<%= @record.numero_de_camiones %></h2>
      <%= form_for [@record, @service], :html => {:id => 'service_form'} do |f| %>

      <div class="field">
        <%= f.label :Autobús %><br>
        <%= f.select :bus_id, Bus.all.collect { |p| [ p.numero, p.id ] } %>
      </div>


      <div class="actions">
        <%= f.submit "Añadir Autobús", class: "button button_red" %> <br><br>
      </div>
      <% end %>
    </div>
<% end %>

    <div id="formario">
      <h2>Itinerario</h2>

      <h3>Distancia: <%= @record.distancia %></h3>   

      <div class="row">
        <% @routes.each_with_index do |route, i| %>
        <div class="col-sm-6">
          <h4><%= i+1 %>.- <%= route.place %>    | <span><%= link_to 'Eliminar', record_route_path(@record, route), method: :delete, data: { confirm: 'Are you sure?' } %></span> |</h4>

        </div>
        <% end %>
      </div>

      <%= form_for [@record, @route], :html => {:id => 'route_form'} do |f| %>

      <div class="field">
        <%= f.label :Nuevo_lugar %><br>
        <%= f.text_field :place %>
      </div>


      <div class="actions">
        <%= f.submit "Añadir Lugar", class: "button button_red" %> <br><br>
      </div>
      <% end %>

    </div>

    <div id="formario">
      <h2>Pagos</h2>
      <div class="content table-responsive table-full-width">
        <table class="table table-hover table-striped">
          <thead>
            <th>Método</th>
            <th>Núm Recibo</th>
            <th>Fecha</th>
            <th>Cantidad</th>
            <th colspan="1"></th>
          </thead>
          <tbody>

            <tr>
              <% @payments.each do |payment| %>
              <td><%= payment.metodo %></td>
              <td><%= payment.num_recibo %></td>
              <td><%= payment.fecha.strftime(" %b-%d-%Y") %></td>
              <td><%= payment.cantidad %></td>
              <td><%= link_to 'Eliminar', record_payment_path(@record, payment), method: :delete, data: { confirm: 'Are you sure?' } %></td>
              <% end %>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td></td>
              <td></td>
              <td>Total:</td>
              <td><%= @record.sum_payments %></td>
            </tr>

          </tbody>
        </table>
      </div>

      <%= form_for [@record, @payment], :html => {:id => 'payment_form'} do |f| %>

      <div class="row">
        <div class="col-sm-3">
          <h4><%= f.label :metodo %></h4>
          <p> <%= f.select :metodo, [["Efectivo"], ["Cheque"], ["Tranferencia"], ["Tarjeta"]], {:prompt => 'Método de pago'}%></p>
        </div>

        <div class="col-sm-3">
          <h4><%= f.label :num_recibo %></h4>
          <p><%= f.text_field :num_recibo, required: true %></p>
        </div>

        <div class="col-sm-3">
          <h4><%= f.label :fecha %></h4>
          <p><%= f.date_field :fecha %></p>
        </div>

        <div class="col-sm-3">
          <h4><%= f.label :cantidad %></h4>
          <p><%= f.number_field :cantidad, required: true %></p>
        </div>
      </div>

      <div class="actions">
        <%= f.submit "Añadir Pago", class: "button button_red" %> <br><br>
      </div>
      <% end %>

    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-12">
    <div id="formario">
      <h2>Cliente</h2>
      <div class="row">

        <div class="col-sm-3">
          <h4>Alias:</h4>
          <p><%= @record.client.alias %></p>
        </div>

        <div class="col-sm-3">
          <h4>Razón Social:</h4>
          <p><%= @record.client.razon_social %></p>
        </div>

        <div class="col-sm-2">
          <h4>R.F.C.:</h4>
          <p><%= @record.client.rfc %></p>
        </div>

        <div class="col-sm-2">
          <h4>Email:</h4>
          <p><%= @record.client.email %></p>
        </div>

        <div class="col-sm-2">
          <h4>Teléfono:</h4>
          <p><%= @record.client.telefono %></p>
        </div>

      </div>

      <div class="row">

        <div class="col-sm-3">
          <h4>Nombre Cobro:</h4>
          <p><%= @record.client.nombre_cobro %></p>
        </div>

        <div class="col-sm-3">
          <h4>Teléfono Cobro:</h4>
          <p><%= @record.client.telefono_cobro %></p>
        </div>

        <div class="col-sm-3">
          <h4>Email Cobro:</h4>
          <p><%= @record.client.email_cobro %></p>
        </div>
      </div>
      <br>

    </div>
  </div>
</div>


<div class="row">
  <% @services.each do |service| %>
  <div class="col-sm-4">
    <div id="formario">
      <h2><%= service.bus.numero %></h2>
      <div class="row">
        <div class="col-md-12">
          <h4 class="upper center grey">PRECIOS</h4>
        </div>
      </div>

      <div class="row">
        <div class="col-sm-6">
          <h4>Precio x unidad</h4>
          <p><%= service.precio_unidad %></p>
        </div>

        <div class="col-sm-6">
          <h4>Día adicional</h4>
          <p><%= service.dia_extra %></p>
        </div>
      </div>

      <div class="row">
        <div class="col-md-12">
          <h4 class="upper center grey">GASTOS</h4>
        </div>
      </div>
      <div class="content table-responsive table-full-width">
        <table class="table table-hover table-striped">
          <thead>
            <th>Gasto</th>
            <th>Cantidad</th>
          </thead>
          <tbody>
            <tr>
              <td>Casetas:</td>
              <td><%= service.caseta %></td>
            </tr>
            <tr>
              <td>Hotel:</td>
              <td><%= service.hotel%></td>
            </tr>
            <tr>
              <td>Viáticos:</td>
              <td><%= service.viaticos%></td>
            </tr>
            <tr>
              <td>Estacionamientos:</td>
              <td><%= service.estacionamientos%></td>
            </tr>
            <tr>
              <td>Lavadas:</td>
              <td><%= service.lavadas%></td>
            </tr>
            <tr>
              <td>Aeropuerto:</td>
              <td><%= service.aeropuerto%></td>
            </tr>
            <tr>
              <td>Diesel:</td>
              <td><%= service.diesel%></td>
            </tr>
            <tr>
              <td>Otros:</td>
              <td><%= service.otros%></td>
            </tr>
            <tr>
              <td></td>
              <td></td>
            </tr>
            <tr>
              <td>Total:</td>
              <td><%= service.sum_gastos%></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="row">
        <div class="col-md-12">
          <h4 class="upper center grey">KILOMETRAJE</h4>
        </div>
      </div>

      <div class="content table-responsive table-full-width">
        <table class="table table-hover table-striped">
          <thead>
            <th>Km Inicial</th>
            <th>Km Final</th>
          </thead>
          <tr>
            <td><% service.km_inicio%></td>
            <td><% service.km_fin%></td>
          </tr>
        </table>
      </div>

    </div>
  </div>
  <% end %>
</div>


